html
  head
    title #{book.title} Â· Nook
    link(rel='stylesheet' href='https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css' integrity='sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO' crossorigin='anonymous')
    script(src='https://code.jquery.com/jquery-3.3.1.slim.min.js' integrity='sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo' crossorigin='anonymous')
    script(src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js' integrity='sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49' crossorigin='anonymous')
    script(src='https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js' integrity='sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy' crossorigin='anonymous')
    script(type="module" src='/javascripts/bookClient.js')
    link(rel='stylesheet', href='/stylesheets/style.css')

body
  include ./partials/header.pug

  p
  .container
    .row
      .col-sm
        - ed = "th"
        - mod100 = book.edition % 100
        - mod10 = book.edition % 10
        if mod10 == 1 && mod100 != 11
          - ed = "st"
        else if mod10 == 2 && mod100 %100 != 12
          - ed = "nd"
        else if mod10 == 3 && mod100 % 100 != 13
          - ed = "rd"

        - genres = ""
        - index = 0
        each genre in book.genres
          if index == book.genres.length - 1
            - genres += genre.name + " "
          else
            - genres += genre.name + ", "
          - index++

        h3 #{book.title}
        p
        h5 Book Information
        p 
          span.font-weight-bold ISBN: 
          span#isbn #{book.isbn}
        p 
          span.font-weight-bold Genre: 
          | #{genres}
        p 
          span.font-weight-bold Description: 
          | #{book.description}
        p 
          span.font-weight-bold Price: 
          | $#{book.price}
        p 
          span.font-weight-bold Number of pages: 
          | #{book.print_length}
        p 
          span.font-weight-bold Edition: 
          | #{book.edition}#{ed}
        p 
          span.font-weight-bold Publisher: 
          | #{book.publisher}
        p 
          span.font-weight-bold Publish date: 
          | #{book.publish_date.toLocaleDateString()}
        br
        h5 Author(s) Information
        p
        each author in book.authors
          h6 #{author.name}
          ul
            li
              span.font-weight-bold Contact:
              |  #{author.email}
            li
              span.font-weight-bold Bio:
              |  #{author.bio}
            li
              span.font-weight-bold Website: 
              a(href="https://www.youtube.com/watch?v=dQw4w9WgXcQ", target="_blank", rel="noopener noreferrer") #{author.website}
        br

        if session.loggedInType == 'customer' && book.stock > 0
          h4 Order
          label(for='quantity')= 'Quantity = '
          span &#32;
          span &#32;
          input#quantity(type='number' name='quantity' min='1' max=book.stock value=(session.cart && session.cart[book.isbn])?session.cart[book.isbn]:1)
          p
          button#addToCart.btn.btn-success Add to cart  
          if session.cart && session.cart[book.isbn]
            span.text-success  You have #{session.cart[book.isbn]} of these in your cart
        else if book.stock = 0
          p OUT OF STOCK
        else
          h4 Remove from database
          button#removeBook.btn.btn-danger Remove
